{
	"name": "PseudoService",

	"namespace": "meDIC\\PseudoService",

	"description": "Pseudonymization and Depseudonymization with E-PIX/gPAS",

	"documentation": "README.md",

	"authors": [		{
			"name": "Christian Erhardt",
			"email": "christian.erhardt@uni-tuebingen.de",
			"institution": "meDIC / Hertie Institute for Clinical Brain Research, University Hospital TÃ¼bingen"
		}
	],

	"permissions": [
        "hook_data_entry_form_top"
	],
	
	"enable-every-page-hooks-on-system-pages":false,	

	"links": {
        "project": [
            {
                "name": "Pseudonyme",
                "icon": "key",
                "url": "index.php",
                "show-header-and-footer": false
            }
        ],
		"control-center": [
		]
	},

	"no-auth-pages": [
	],

	"project-settings": [
          {
              "key": "save_sap_id",
              "name": "save SAP-ID in REDCap",
              "super-users-only": true,
              "type": "checkbox",
              "branchingLogic": {
                "field": "use_sap",
                "value": "true"
              }
          },
          {
              "key": "sap_id_field",
              "name": "field to store SAP-ID <br><small style='color:#da0000;'>field needs to be marked as identifying</small></b style='color:black'> ",
              "type": "field-list",
              "autocomplete": true,
              "super-users-only": true,
                "branchingLogic": {
                    "conditions": [
                        {
                            "field": "use_sap",
                            "value": "true"
                        },
                        {
                            "field": "save_sap_id",
                            "value": "true"
                        }
                    ]
                }
          },
          {
              "key": "sap_id_event",
              "name": "event to store SAP-ID",
              "type": "event-list",
              "super-users-only": true,
                "branchingLogic": {
                    "conditions": [
                        {
                            "field": "use_sap",
                            "value": "true"
                        },
                        {
                            "field": "save_sap_id",
                            "value": "true"
                        }
                    ]
                }
          },

        {
             "key": "project_title",
             "name": "<p style='font-size:large'>Project Settings</p>",
             "type": "descriptive"
        },
        {
            "key": "gpas_domain",
            "name": "gPAS domain",
            "required": true,
            "super-users-only": true,
            "type": "text"
        },
        {
            "key": "extern",
            "name": "use external probands",
            "super-users-only": true,
            "type": "checkbox",
            "branchingLogic": {
                "field": "use_epix",
                "value": "true"
            }
        },
        {
             "key": "extpsn_title",
             "name": "<p style='font-size:large'>External IDs Settings</p>",
             "type": "descriptive"
        },
          {
            "key": "extpsn",
            "name": "use external IDs",
            "super-users-only": true,
            "type": "checkbox"
          },
          {
              "key": "extpsn_label",
              "name": "Custom label for ID field",
              "type": "text",
              "super-users-only": true,
              "branchingLogic": {
                  "field": "extpsn",
                  "value": "true"
              }
          },
          {
              "key": "extpsn_prefix",
              "name": "extPSN: prefix",
              "type": "text",
              "super-users-only": true,
              "branchingLogic": {
                  "field": "extpsn",
                  "value": "true"
              }
          },
          {
              "key": "use_9_digits_pat_id",
              "name": "allow 9 digits input for Pat.-ID (default: 10 digits)",
              "type": "checkbox",
              "super-users-only": true,
              "branchingLogic": {
                  "field": "extpsn",
                  "value": "true"
              }
          },
          {
              "key": "extpsn_field",
              "name": "Field to store pseudonym",
              "type": "field-list",
              "autocomplete": true,
              "super-users-only": true,
              "branchingLogic": {
                  "field": "extpsn",
                  "value": "true"
              }
          },
          {
              "key": "extpsn_event",
              "name": "Event to store pseudonym",
              "type": "event-list",
              "super-users-only": true,
              "branchingLogic": {
                  "field": "extpsn",
                  "value": "true"
              }
          },
        {
             "key": "cust_vars_title",
             "name": "<p style='font-size:large'>Custom Fields Settings</p>",
             "type": "descriptive",
             "branchingLogic": {
                "conditions": [
                    {
                        "field": "use_epix",
                        "value": "true"
                    },
                    {
                        "field": "extern",
                        "value": "true"
                    }
                ]
             }
        },
        {
           "key": "cust-vars-list",
           "name": "additional fields",
           "required": false,
           "type": "sub_settings",
           "repeatable":true,
           "branchingLogic": {
                "conditions": [
                    {
                        "field": "use_epix",
                        "value": "true"
                    },
                    {
                        "field": "extern",
                        "value": "true"
                    }
                ]
           },
           "sub_settings":[
              {
                 "key": "custom_field",
                 "name": "custom field",
                 "required": false,
                  "type": "dropdown",
                  "choices": [
                    {
                      "value": 1,
                      "name": "value1"
                    },
                    {
                      "value": 2,
                      "name": "value2"
                    },
                    {
                      "value": 3,
                      "name": "value3"
                    },
                    {
                      "value": 4,
                      "name": "value4"
                    },
                    {
                      "value": 5,
                      "name": "value5"
                    },
                    {
                      "value": 6,
                      "name": "value6"
                    },
                    {
                      "value": 7,
                      "name": "value7"
                    },
                    {
                      "value": 8,
                      "name": "value8"
                    },
                    {
                      "value": 9,
                      "name": "value9"
                    }
                  ]
              },
              {
                 "key": "custom_label",
                 "name": "custom label",
                 "required": false,
                 "type": "text"
              }
           ]
          },
          {
               "key": "search_title",
               "name": "<p style='font-size:large'>Search Setting</p>",
               "type": "descriptive"
          },
          {
              "key": "maxcnt",
              "name": "max. search hits",
              "required": false,
              "type": "text"
          }

	],

	"system-settings": [
        {
             "key": "auth_title",
             "name": "<p style='font-size:large'>Authorization Settings</p>",
             "type": "descriptive",
             "allow-project-overrides": true
        },
        {
            "key": "auth_type1",
            "name": "Login Authentication Type 1",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "type": "dropdown",
            "choices": [
              {
                "value": "basic",
                "name": "Basic Auth"
              },
              {
                "value": "oidc_client",
                "name": "OIDC client credentials"
              },
              {
                "value": "oidc_flow",
                "name": "OIDC auth code flow"
              }
            ]
        },
        {
            "key": "basic_name1",
            "name": "Basic Auth 1: username",
            "type": "password",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "field": "auth_type1",
                "value": "basic"
            }
        },
        {
            "key": "basic_secret1",
            "name": "Basic Auth 1: secret",
            "type": "password",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "field": "auth_type1",
                "value": "basic"
            }
        },
        {
            "key": "authorization_url1",
            "name": "Authorization Server 1: URL",
            "type": "text",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "type": "or",
                "conditions": [
                    {
                        "field": "auth_type1",
                        "value": "oidc_client"
                    },
                    {
                        "field": "auth_type1",
                        "value": "oidc_flow"
                    }
                ]
            }
        },
        {
            "key": "client_id1",
            "name": "OIDC Server 1: Client ID",
            "type": "password",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "type": "or",
                "conditions": [
                    {
                        "field": "auth_type1",
                        "value": "oidc_client"
                    },
                    {
                        "field": "auth_type1",
                        "value": "oidc_flow"
                    }
                ]
            }
        },    
        {
            "key": "secret1",
            "name": "OIDC Server 1: Client secret",
            "type": "password",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "type": "or",
                "conditions": [
                    {
                        "field": "auth_type1",
                        "value": "oidc_client"
                    },
                    {
                        "field": "auth_type1",
                        "value": "oidc_flow"
                    }
                ]
            }
        },    
        
        {
            "key": "auth_type2",
            "name": "Login Authentication Type 2",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "type": "dropdown",
            "choices": [
              {
                "value": "basic",
                "name": "Basic Auth"
              },
              {
                "value": "oidc_client",
                "name": "OIDC client credentials"
              },
              {
                "value": "oidc_flow",
                "name": "OIDC auth code flow"
              }
            ],
            "branchingLogic": {
                "field": "auth_type1",
                "value": "true"
            }
        },
        {
            "key": "basic_name2",
            "name": "Basic Auth 2: username",
            "type": "password",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "field": "auth_type2",
                "value": "basic"
            }
        },
        {
            "key": "basic_secret2",
            "name": "Basic Auth 2: secret",
            "type": "password",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "field": "auth_type2",
                "value": "basic"
            }
        },
        {
            "key": "authorization_url2",
            "name": "Authorization Server 2: URL",
            "type": "text",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "type": "or",
                "conditions": [
                    {
                        "field": "auth_type2",
                        "value": "oidc_client"
                    },
                    {
                        "field": "auth_type2",
                        "value": "oidc_flow"
                    }
                ]
            }
        },
        {
            "key": "client_id2",
            "name": "OIDC Server 2: Client ID",
            "type": "password",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "type": "or",
                "conditions": [
                    {
                        "field": "auth_type2",
                        "value": "oidc_client"
                    },
                    {
                        "field": "auth_type2",
                        "value": "oidc_flow"
                    }
                ]
            }
        },    
        {
            "key": "secret2",
            "name": "OIDC Server 2: Client secret",
            "type": "password",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "type": "or",
                "conditions": [
                    {
                        "field": "auth_type2",
                        "value": "oidc_client"
                    },
                    {
                        "field": "auth_type2",
                        "value": "oidc_flow"
                    }
                ]
            }
        },    
        
        {
            "key": "auth_type3",
            "name": "Login Authentication Type 3",
            "required": false,
            "allow-project-overrides": true,
            "type": "dropdown",
            "choices": [
              {
                "value": "basic",
                "name": "Basic Auth"
              },
              {
                "value": "oidc_client",
                "name": "OIDC client credentials"
              },
              {
                "value": "oidc_flow",
                "name": "OIDC auth code flow"
              }
            ],
            "branchingLogic": {
                "field": "auth_type2",
                "value": "true"
            }
        },
        {
            "key": "basic_name3",
            "name": "Basic Auth 3: username",
            "type": "password",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "field": "auth_type3",
                "value": "basic"
            }
        },
        {
            "key": "basic_secret3",
            "name": "Basic Auth 3: secret",
            "type": "password",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "field": "auth_type3",
                "value": "basic"
            }
        },
        {
            "key": "authorization_url3",
            "name": "Authorization Server 3: URL",
            "type": "text",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "type": "or",
                "conditions": [
                    {
                        "field": "auth_type3",
                        "value": "oidc_client"
                    },
                    {
                        "field": "auth_type3",
                        "value": "oidc_flow"
                    }
                ]
            }
        },
        {
            "key": "client_id3",
            "name": "OIDC Server 3: Client ID",
            "type": "password",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "type": "or",
                "conditions": [
                    {
                        "field": "auth_type3",
                        "value": "oidc_client"
                    },
                    {
                        "field": "auth_type3",
                        "value": "oidc_flow"
                    }
                ]
            }
        },    
        {
            "key": "secret3",
            "name": "OIDC Server 3: Client secret",
            "type": "password",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "type": "or",
                "conditions": [
                    {
                        "field": "auth_type3",
                        "value": "oidc_client"
                    },
                    {
                        "field": "auth_type3",
                        "value": "oidc_flow"
                    }
                ]
            }
        },    
        
        {
             "key": "gpas_title",
             "name": "<p style='font-size:large'>gPAS Settings</p>",
             "type": "descriptive"
        },
        {
            "key": "gpas_url",
            "name": "gPAS API URL",
            "required": true,
            "allow-project-overrides": true,
            "type": "text"
        },
        {
            "key": "gpas_auth_type",
            "name": "gPAS Authentication Type",
            "required": true,
            "allow-project-overrides": true,
            "type": "dropdown",
            "choices": [
              {
                "value": "1",
                "name": "Auth Type 1"
              },
              {
                "value": "2",
                "name": "Auth Type 2"
              },
              {
                "value": "3",
                "name": "Auth Type 3"
              }
            ]
        },
        
        {
            "key": "gpas_scope",
            "name": "gPAS OIDC Scope",
            "required": false,
            "allow-project-overrides": true,
            "type": "text"
        },
        {
            "key": "gpas_domain_url",
            "name": "gPAS Domain API URL",
            "required": true,
            "allow-project-overrides": true,
            "type": "text"
        },
        {
            "key": "gpas_domain_scope",
            "name": "gPAS Domain Scope",
            "required": false,
            "allow-project-overrides": true,
            "type": "text"
        },

        {
             "key": "epix_title",
             "name": "<p style='font-size:large'>E-PIX Settings</p>",
             "type": "descriptive",
             "allow-project-overrides": true
        },
        {
            "key": "use_epix",
            "name": "Use E-PIX?",
            "type": "checkbox",
            "allow-project-overrides": true,
            "super-users-only": true
        },
        {
            "key": "epix_auth_type",
            "name": "E-PIX Authentication Type",
            "required": true,
            "allow-project-overrides": true,
            "type": "dropdown",
            "choices": [
              {
                "value": "1",
                "name": "Auth Type 1"
              },
              {
                "value": "2",
                "name": "Auth Type 2"
              },
              {
                "value": "3",
                "name": "Auth Type 3"
              }
            ],
            "branchingLogic": {
                "field": "use_epix",
                "value": true
            }
        },
        {
            "key": "epix_url",
            "name": "E-PIX API URL",
            "required": true,
            "type": "text",
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "field": "use_epix",
                "value": true
            }
        },
        {
            "key": "epix_scope",
            "name": "E-PIX OIDC Scope",
            "required": false,
            "type": "text",
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "field": "use_epix",
                "value": true
            }
        },
        {
            "key": "epix_domain",
            "name": "E-PIX Domain",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "field": "use_epix",
                "value": true
            }
        },
        {
            "key": "epix_safe_source",
            "name": "E-PIX safe source",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "field": "use_epix",
                "value": true
            }
        },
        {
            "key": "epix_external_source",
            "name": "E-PIX external source",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "field": "use_epix",
                "value": true
            }
        },
        {
            "key": "epix_id_domain",
            "name": "E-PIX ID Domain",
            "required": true,
            "allow-project-overrides": true,
            "super-users-only": true,
            "branchingLogic": {
                "field": "use_epix",
                "value": true
            }
        },
        {
             "key": "sap_title",
             "name": "<p style='font-size:large'>SAP Settings</p>",
             "type": "descriptive",
             "allow-project-overrides": true
        },
        {
            "key": "use_sap",
            "name": "Use SAP?",
            "allow-project-overrides": true,
            "super-users-only": true,
            "type": "checkbox"
        },
        {
            "key": "sap_auth_type",
            "name": "SAP Authentication Type",
            "required": true,
            "type": "dropdown",
            "choices": [
              {
                "value": "1",
                "name": "Auth Type 1"
              },
              {
                "value": "2",
                "name": "Auth Type 2"
              },
              {
                "value": "3",
                "name": "Auth Type 3"
              }
            ],
            "branchingLogic": {
                "field": "use_sap",
                "value": true
            }
        },
        {
            "key": "sap_url",
            "name": "SAP API URL",
            "required": true,
            "type": "text",
            "branchingLogic": {
                "field": "use_sap",
                "value": true
            }
        },
        {
            "key": "sap_scope",
            "name": "SAP OIDC Scope",
            "required": false,
            "type": "text",
            "branchingLogic": {
                "field": "use_sap",
                "value": true
            }
        },
        {
            "key": "sap_filter_pid",
            "name": "SAP Filter: IS-H ID",
            "required": true,
            "type": "text",
            "branchingLogic": {
                "field": "use_sap",
                "value": "true"
            }
        },
        {
            "key": "sap_filter_lastname",
            "name": "SAP Filter: Last Name",
            "required": true,
            "type": "text",
            "branchingLogic": {
                "field": "use_sap",
                "value": "true"
            }
        },
        {
            "key": "sap_filter_firstname",
            "name": "SAP Filter: First Name",
            "required": true,
            "type": "text",
            "branchingLogic": {
                "field": "use_sap",
                "value": "true"
            }
        },
        {
            "key": "sap_filter_dob_from",
            "name": "SAP Filter: Date of Birth FROM",
            "required": true,
            "type": "text",
            "branchingLogic": {
                "field": "use_sap",
                "value": "true"
            }
        },
        {
            "key": "sap_filter_dob_to",
            "name": "SAP Filter: Date of Birth TO",
            "required": true,
            "type": "text",
            "branchingLogic": {
                "field": "use_sap",
                "value": "true"
            }
        },
        {
            "key": "use_proxy",
            "name": "use proxy",
            "type": "checkbox"
        }
	],

	"crons": [
	],

	"compatibility": {
		"php-version-min": "",
		"php-version-max": "",
		"redcap-version-min": "",
		"redcap-version-max": ""
	}
}